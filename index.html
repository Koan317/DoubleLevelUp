<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8" />
    <title>双升</title>
    <link rel="stylesheet" href="style.css" />
</head>

<body class="light">
    <div id="app">
        <div id="play-area">
            <div id="table">
                <div class="played north"></div>
                <div class="played west"></div>
                <div class="played east"></div>
                <div class="played south"></div>

                <div id="kitty"></div>
                <div id="reveal-countdown" class="reveal-countdown hidden"></div>
                <div id="banker-badge" class="banker-badge hidden"></div>
                <div id="hand-actions">
                    <div id="trump-actions" class="trump-actions hidden"></div>
                    <button id="playButton">出牌</button>
                </div>
                <div id="hand" class="hand-cards"></div>
            </div>
        </div>
        <div id="sidebar">
            <button id="themeToggle">切换桌面</button>
            <div id="score-display" class="score-display"></div>
            <div id="status"></div>
            <div id="rule-message" class="rule-message"></div>
            <details id="rules-panel" class="rules-panel" open>
                <summary>游戏规则</summary>
                <div class="rules-content">
                    <h4>基础设定</h4>
                    <ul>
                        <li>游戏别名：拖拉机 / 80分 / 双升 / 双抠。</li>
                        <li>4人游戏，东西为一队，南北为一队。庄家负责跑分，闲家负责得分。</li>
                        <li>两副扑克牌共108张，每人25张，底牌8张。</li>
                        <li>等级：2 起始，按 2-3-4-5-6-7-8-9-10-J-Q-K-A-王 循环升级，王不分大小。</li>
                    </ul>
                    <h4>牌型</h4>
                    <ul>
                        <li>单：一张牌。</li>
                        <li>对：两张同花色同数字。</li>
                        <li>拖拉机：同花色相邻联对（最少2对，最多自然12对）。</li>
                        <li>甩牌：单/对/拖拉机的组合，需保证最大性，否则强制缩牌。</li>
                    </ul>
                    <h4>主副牌与大小</h4>
                    <ul>
                        <li>亮出与庄家等级相同数字的牌确定主花色，所有主数字与主花色均为主牌，大小王固定为主。</li>
                        <li>无主时：若等级非王，则大小王+主数字12张为主；若等级为王，则仅大小王为主。</li>
                        <li>以打10为例：主牌大小为大王 &gt; 小王 &gt; 主10 &gt; 副10 &gt; A K Q J 9 8 7 6 5 4 3 2；副牌为 A K Q J 9 8 7 6 5 4 3 2。</li>
                        <li>拖拉机举例：22 33、66 77 88；打10时 99 JJ 也可视作拖拉机。</li>
                    </ul>
                    <h4>亮牌与翻牌</h4>
                    <ul>
                        <li>首轮抢庄：抓牌阶段最先亮主者为庄。亮牌需 1 张或 1 对“2”+同色王（大王配♥/♦，小王配♠/♣）。</li>
                        <li>后续轮次：抓牌结束后由庄家亮牌；若庄家不能亮由队友亮，庄家不变。</li>
                        <li>庄家队都无法亮：庄闲互换，新庄家为原庄家右手玩家，亮自己队伍的主。</li>
                        <li>等级为王时，只需亮任意一张王。</li>
                        <li>四人都无法亮主则翻底牌：按顺序翻底牌，找到同花色同数字的另一张牌持有者为庄；底牌全为对子则重新抓牌。</li>
                        <li>抓牌结束后显示 6 秒倒计时，庄家拿底牌并扣 8 张。</li>
                    </ul>
                    <h4>加强与拧牌</h4>
                    <ul>
                        <li>首轮亮 1 王 + 1 张 2 后，若再抓到同花色的 2，可加强为 1 王 + 1 对 2。</li>
                        <li>拧牌顺序：2大王 &gt; 2小王 &gt; 王+对 &gt; 王+单（等级为王时：2大王 &gt; 2小王 &gt; 任意王）。</li>
                        <li>拧牌者获得底牌并重新扣 8 张，可继续拧牌。</li>
                        <li>2大王/2小王称“反无主”，此时仅大小王与主数字为主。</li>
                    </ul>
                    <h4>出牌</h4>
                    <ul>
                        <li>同等大小以先出者为大。</li>
                        <li>首家可出单/对/拖拉机或甩牌（需最大性，否则强制缩牌）。</li>
                        <li>跟牌需尽最大义务：同花色、同牌型、同张数；不满足可贴牌（最小）。</li>
                        <li>毙牌：用主牌出相同牌型，算大于首家；多家毙牌按主牌大小比较。</li>
                        <li>甩牌比较顺序：拖拉机 &gt; 对 &gt; 单；最大者下一轮先手。</li>
                    </ul>
                    <h4>轮庄与计分</h4>
                    <ul>
                        <li>争庄先亮者为庄；庄家升级下一副由队友坐庄；闲家上台下一副由本副庄家右手玩家坐庄。</li>
                        <li>分牌：5=5分，10/K=10分。</li>
                        <li>升级：得分0→庄家连升4级；&lt;40→庄家连升2级；40-79→庄家升1级；80-119→换庄；120-159→得分方升1级；160-199→得分方连升2级；此后每40分递推。</li>
                    </ul>
                    <h4>抠底</h4>
                    <ul>
                        <li>最后一回合最大者属于得分队伍则抠底成功，底牌分数乘倍数计入得分。</li>
                        <li>倍数：单*1，对*2，2对拖拉机*4，3对*8，以此类推。</li>
                        <li>甩牌按拖拉机&gt;对&gt;单决定倍数，例如 44 55 7 99 有2对拖拉机则*4。</li>
                    </ul>
                </div>
            </details>
        </div>
    </div>

    <script src="./card-deck.js"></script>
    <script src="./card-rules.js"></script>
    <script src="./play-patterns.js"></script>
    <script src="./trick-rules.js"></script>
    <script src="./trump-reveal.js"></script>
    <script src="./scoring.js"></script>
    <script src="./ai-play.js"></script>
    <script src="./ui-render.js"></script>
    <script src="./game-state.js"></script>
    <script src="./app.js"></script>

</body>
</html>
